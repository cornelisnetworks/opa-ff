.\" .\" *********************************************************************
.\" .\" *                                                                   *
.\" .\" *             Copyright 2015-2016, Intel Corporation                *
.\" .\" *                                                                   *
.\" .\" *                       All Rights Reserved.                        *
.\" .\" *                                                                   *
.\" .\" *********************************************************************

.TH opagentopology 8 "Intel Corporation" "Copyright(C) 2015\-2016" "Master map: IFSFFCLIRG (Man Page)" 
.SH NAME
opagentopology

.NL

.PP
Generates sample topology verification XML. Provides an example of using opaxmlgenerate and is a prototype for customization.
.PP
Uses CSV input files opatopology\(ullinks.txt, opatopology\(ulFIs.txt, and opatopology\(ulSWs.txt to generate LinkSummary, Node FIs, and Node SWs information respectively. These files are samples of what might be produced as part of translating a user custom file format into temporary intermediate CSV files.
.PP
LinkSummary information includes Link, Cable, and Port information. Note that opagentopology (not opaxmlgenerate) generates the XML version string as well as the #8217lt;Topology> and <LinkSummary> lines. Also note that the indent level is at the default value of zero (0). The portions of the script that call opaxmlgenerate follow:
.PP

.br
opaxmlgenerate -X /usr/lib/opa-ff/samples/opatopology\(ul1.txt -d \; -h Link -g Rate -g
.br
Rate\(ulInt -g MTU -g LinkDetails -h Cable -g CableLength -g CableLabel -g
.br
CableDetails -e Cable -h Port -g NodeGUID -g PortNum -g NodeDesc -g PortGUID -g
.br
NodeType -g NodeType\(ulInt -g PortDetails -e Port -h Port -g NodeGUID -g PortNum -g
.br
NodeDesc -g PortGUID -g NodeType -g NodeType\(ulInt -g PortDetails -e Port -e Link
.br

.br
opaxmlgenerate -X /usr/lib/opa-ff/samples/opatopology\(ul2.txt -d \; -h Node -g NodeGUID -g
.br
NodeDesc -g NodeDetails -g HostName -g NodeType -g NodeType\(ulInt -g NumPorts -e Node

.br

.NL

.SH opatopology\(ullinks.txt
.NL

.PP
This file can be found in /usr/lib/opa-ff/samples/ . For brevity, this sample shows only two links. The second link shows an example of omitting some information. In the second line, the MTU, LinkDetails, and other fields are not present, which is indicated by an empty value for the field (no entry between the semicolon delimiters).
.PP

.B NOTE:
The following example exceeds the available width of the page. For readability, a blank line is shown between lines to make it clear where the line ends. In an actual link file, no blank lines are used.

25g;2048;0;IO Server Link;11m;S4567;cable model 456;0x0002c9020020e004;1;bender HFI-1;0x0002c9020020e004;FI;Some info about port;0x0011750007000df6;7;Switch 1234 Leaf 4;;SW;
.br
25g;;0;;;;;0x0002c9020025a678;1;mindy2 HFI-1;;FI;;0x0011750007000e6d;4;Switch 2345 Leaf 5;;SW;
.NL

.SH opatopology\(ulFIs.txt
.NL

.PP
This file can be found in /usr/lib/opa-ff/samples/ . For brevity, this sample shows only two nodes.
.PP

.br
0x0002c9020020e004;bender HFI-1;More details about node
.br
0x0002c9020025a678;mindy2 HFI-1;Node details

.br

.NL

.SH opatopology\(ulSWs.txt
.NL

.PP
This file can be found in /usr/lib/opa-ff/samples/ . For brevity, this sample shows only two nodes.
.PP

.br
0x0011750007000df6;Switch 1234 Leaf 4; 0x0011750007000e6d;Switch 2345 Leaf 5;

.br

.NL

.SH opatopology\(ulSMs.txt
.NL

.PP
This file can be found in /usr/lib/opa-ff/samples/ . For brevity, this sample shows only one node.
.PP

.br
0x0002c9020025a678;1;mindy2 HFI-1;0x0011750007000e6d;FI;details about SM

.br

.SH Example 
.NL

.PP
When run against the supplied topology input files, opagentopology produces:
.PP

.br
#8217lt;?xml version="1.0" encoding="utf-8" ?>
.br
#8217lt;Topology>
.br
#8217lt;LinkSummary>
.br
#8217lt;Link>
.br
#8217lt;Rate>25g</Rate>
.br
#8217lt;MTU>2048</MTU>
.br
#8217lt;Internal>0</Internal>
.br
#8217lt;LinkDetails>IO Server Link</LinkDetails>
.br
#8217lt;Cable>
.br
#8217lt;CableLength>11m</CableLength>
.br
#8217lt;CableLabel>S4567</CableLabel>
.br
#8217lt;CableDetails>cable model 456</CableDetails>
.br
#8217lt;/Cable>
.br
#8217lt;Port>
.br
#8217lt;NodeGUID>0x0002c9020020e004</NodeGUID>
.br
#8217lt;PortNum>1</PortNum>
.br
#8217lt;NodeDesc>bender HFI-1</NodeDesc>
.br
#8217lt;PortGUID>0x0002c9020020e004</PortGUID>
.br
#8217lt;NodeType>FI</NodeType>
.br
#8217lt;PortDetails>Some info about port</PortDetails>
.br
#8217lt;/Port>
.br
#8217lt;Port>
.br
#8217lt;NodeGUID>0x0011750007000df6</NodeGUID>
.br
#8217lt;PortNum>7</PortNum>
.br
#8217lt;NodeDesc>Switch 1234 Leaf 4</NodeDesc>
.br
#8217lt;NodeType>SW</NodeType>
.br
#8217lt;/Port>
.br
#8217lt;/Link>
.br
#8217lt;Link>
.br
#8217lt;Rate>25g</Rate>
.br
#8217lt;Internal>0</Internal>
.br
#8217lt;Cable>
.br
#8217lt;/Cable>
.br
#8217lt;Port>
.br
#8217lt;NodeGUID>0x0002c9020025a678</NodeGUID>
.br
#8217lt;PortNum>1</PortNum>
.br
#8217lt;NodeDesc>mindy2 HFI-1</NodeDesc>
.br
#8217lt;NodeType>FI</NodeType>
.br
#8217lt;/Port>
.br
#8217lt;Port>
.br
#8217lt;NodeGUID>0x0011750007000e6d</NodeGUID>
.br
#8217lt;PortNum>4</PortNum>
.br
#8217lt;NodeDesc>Switch 2345 Leaf 5</NodeDesc>
.br
#8217lt;NodeType>SW</NodeType>
.br
#8217lt;/Port>
.br
#8217lt;/Link>
.br
#8217lt;/LinkSummary>
.br
#8217lt;Nodes>
.br
#8217lt;FIs>
.br
#8217lt;Node>
.br
#8217lt;NodeGUID>0x0002c9020020e004</NodeGUID>
.br
#8217lt;NodeDesc>bender HFI-1</NodeDesc>
.br
#8217lt;NodeDetails>More details about node</NodeDetails>
.br
#8217lt;/Node>
.br
#8217lt;Node>
.br
#8217lt;NodeGUID>0x0002c9020025a678</NodeGUID>
.br
#8217lt;NodeDesc>mindy2 HFI-1</NodeDesc>
.br
#8217lt;NodeDetails>Node details</NodeDetails>
.br
#8217lt;/Node>
.br
#8217lt;/FIs>
.br
#8217lt;Switches>
.br
#8217lt;Node>
.br
#8217lt;NodeGUID>0x0011750007000df6</NodeGUID>
.br
#8217lt;NodeDesc>Switch 1234 Leaf 4</NodeDesc>
.br
#8217lt;/Node>
.br
#8217lt;Node>
.br
#8217lt;NodeGUID>0x0011750007000e6d</NodeGUID>
.br
#8217lt;NodeDesc>Switch 2345 Leaf 5</NodeDesc>
.br
#8217lt;/Node>
.br
#8217lt;/Switches>
.br
#8217lt;SMs>
.br
#8217lt;SM>
.br
#8217lt;NodeGUID>0x0002c9020025a678</NodeGUID>
.br
#8217lt;PortNum>1</PortNum>
.br
#8217lt;NodeDesc>mindy2 HFI-1</NodeDesc>
.br
#8217lt;PortGUID>0x0011750007000e6d</PortGUID>
.br
#8217lt;NodeType>FI</NodeType>
.br
#8217lt;SMDetails>details about SM</SMDetails>
.br
#8217lt;/SM>
.br
#8217lt;/SMs>
.br
#8217lt;/Nodes>
.br
#8217lt;/Topology>

.br
